# ChartGenius - Контекст проекта (Обновленный)

## Описание проекта
ChartGenius - это веб-приложение для технического анализа криптовалют с использованием AI. Проект мигрирован с Gemini AI на Augment Agent и реализует полную спецификацию интерфейса для анализа торговых данных.

## Архитектура проекта

### Основные компоненты

#### 1. Компоненты пользовательского интерфейса
- **App.tsx** - главный компонент приложения
- **Chart.tsx** - основной компонент графика с TradingView Lightweight Charts
- **Controls.tsx** - панель управления с 4 кнопками (Тренды, Осцилляторы, Структуры AI, Рекомендации)
- **AnalysisPanel.tsx** - панель с результатами анализа AI
- **ElementDetailsPanel.tsx** - панель с подробными объяснениями активных элементов
- **NewAnalysisModal.tsx** - модальное окно для создания нового анализа
- **UserProfileMenu.tsx** - выпадающее меню профиля пользователя

#### 2. Классы управления графиком
- **ChartAnalysisLayers.ts** - управление аналитическими слоями AI на графике
- **ChartIndicators.ts** - управление техническими индикаторами на основной панели
- **ChartSubPanels.ts** - управление индикаторами на отдельных панелях

#### 3. Утилиты и типы
- **chartAnalysisUtils.ts** - типы данных, цветовая схема, вспомогательные функции
- **dataLoader.ts** - загрузка и парсинг данных из файлов

### Структура данных

#### Входные данные (prompt_1749228821.txt)
Массив объектов свечей, каждый содержит:
- Базовые данные: Open Time, Open, High, Low, Close, Volume
- Технические индикаторы: MA_20, MA_50, MA_100, MA_200, RSI, MACD, Bollinger_Upper/Middle/Lower, и др.

#### Данные анализа AI (chatgpt_response_1749229059.json)
Структурированный анализ содержащий:
- support_resistance_levels: уровни поддержки и сопротивления
- trend_lines: линии тренда
- fibonacci_analysis: уровни коррекции Фибоначчи
- imbalances: зоны дисбаланса
- unfinished_zones: незавершенные зоны
- candlestick_patterns: свечные паттерны
- divergence_analysis: дивергенции
- elliott_wave_analysis: волны Эллиотта
- price_prediction: прогноз цены с virtual_candles
- recommendations: торговые рекомендации

## Реализованная функциональность

### ✅ Полностью реализовано

#### AI-анализ (100%)
- Уровни поддержки/сопротивления (горизонтальные линии)
- Линии тренда (отрезки между точками)
- Коррекция по Фибоначчи (уровни для локального и глобального трендов)
- Зоны дисбаланса (прямоугольники)
- Незавершенные зоны (горизонтальные линии)
- Свечные паттерны (маркеры)
- Дивергенции (круглые маркеры)
- Волны Эллиотта (соединенные отрезки с метками)
- Визуальный прогноз (полупрозрачные свечи)
- Торговые рекомендации (линии входа/стопа/тейка)

#### Интерфейс (100%)
- Модальное окно "Новый анализ" с полями тикер/таймфрейм/количество свечей
- Профиль пользователя с выпадающим меню
- 4 панели управления слоями согласно спецификации
- Панель "Детали элемента" с динамическими объяснениями
- Система независимых переключателей

#### Технические индикаторы (архитектурно готово)
- Основная панель: MA (20,50,100,200), Bollinger Bands, Ichimoku Cloud, Parabolic SAR, VWAP, MA Envelopes
- Отдельные панели: Volume, RSI, MACD, Stochastic, Williams %R, ADX, ATR, OBV

## Ключевые файлы для понимания проекта

### Обязательные для изучения
1. **docs/спецификация интерфейса.md** - единственный источник требований
2. **docs/Описание структур данных.md** - референс по структурам данных
3. **src/App.tsx** - точка входа, общая архитектура
4. **src/components/Chart.tsx** - основная логика графика и интеграции
5. **src/components/ChartAnalysisLayers.ts** - реализация AI-анализа
6. **src/utils/chartAnalysisUtils.ts** - типы и утилиты

### Важные для работы
7. **src/api/dataLoader.ts** - загрузка данных
8. **src/components/Controls.tsx** - панели управления
9. **src/components/ElementDetailsPanel.tsx** - система объяснений
10. **src/components/ChartIndicators.ts** - технические индикаторы
11. **src/components/ChartSubPanels.ts** - индикаторы на подпанелях

### Данные
12. **sample_data/prompt_1749228821.txt** - входные данные с индикаторами
13. **sample_data/chatgpt_response_1749229059.json** - результаты AI-анализа

## Технологический стек
- **React 18** с TypeScript
- **TradingView Lightweight Charts** для графиков
- **Tailwind CSS** для стилизации
- **Vite** для сборки и разработки

## Команды для работы
```bash
# Установка зависимостей
npm install

# Запуск в режиме разработки
npm run dev

# Проверка TypeScript
npx tsc --noEmit

# Сборка для продакшена
npm run build
```

## Цветовая схема
- Поддержка: #26A69A (зеленый)
- Сопротивление: #EF5350 (красный)
- Фибоначчи: #FFB74D (оранжевый)
- Дивергенции: #2196F3 (синий)
- Волны Эллиотта: #9E9E9E (серый)
- Прогноз: #607D8B (серо-синий)

## Состояние системы переключателей
Все элементы управляются через объект `toggles` в App.tsx:
- Каждый элемент имеет независимый переключатель
- При активации отображается на графике и в панели деталей
- При деактивации должен удаляться с графика (ПРОБЛЕМА)

## Интеграция с API
Структура готова для подключения реального API:
- Функция handleNewAnalysis в App.tsx для новых запросов
- dataLoader.ts легко адаптируется под API endpoints
- Все компоненты работают с типизированными данными
